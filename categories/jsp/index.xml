<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>JSP on yaoxieの自留地</title>
        <link>https://yaoxiaoxie.github.io/categories/jsp/</link>
        <description>Recent content in JSP on yaoxieの自留地</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>zh-cn</language>
        <copyright>yaoxieの孤岛</copyright>
        <lastBuildDate>Sun, 01 Sep 2024 23:37:54 +0800</lastBuildDate><atom:link href="https://yaoxiaoxie.github.io/categories/jsp/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>JSP 简单入门与 IDEA 开发环境配置</title>
        <link>https://yaoxiaoxie.github.io/p/jsp/</link>
        <pubDate>Sun, 01 Sep 2024 23:37:54 +0800</pubDate>
        
        <guid>https://yaoxiaoxie.github.io/p/jsp/</guid>
        <description>&lt;img src="https://yaoxiaoxie.github.io/img/face1.jpg" alt="Featured image of post JSP 简单入门与 IDEA 开发环境配置" /&gt;&lt;p&gt;&lt;code&gt;JSP 简单入门与 IDEA 开发环境配置&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;在学 Java 连接数据库时老师提到过 JSP，刚好这个学期有 JSP 的课程，现做一些基础以及环境配置的介绍。&lt;/p&gt;
&lt;h1 id=&#34;什么是-jsp&#34;&gt;什么是 JSP？
&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;动态网页技术标准&lt;/li&gt;
&lt;li&gt;能把 Java 代码嵌入静态的页面中&lt;/li&gt;
&lt;li&gt;JSP 编译器把 JSP 文件编译成 Java 写的 &lt;code&gt;Servlet(服务器端程序)&lt;/code&gt;，再交由 Java 编译器&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;html&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &amp;lt;title&amp;gt;Hello world!&amp;lt;/title&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &amp;lt;body&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &amp;lt;%=out.println(&amp;#34;Hello world!&amp;#34;)%&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &amp;lt;/body&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;/html&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h1 id=&#34;环境配置&#34;&gt;环境配置
&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;语言环境：JDK&lt;/li&gt;
&lt;li&gt;网页服务器：Tomcat，安装教程&lt;/li&gt;
&lt;li&gt;IDE：IntelliJ IDEA / Eclipse&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;前两点非常简单不再赘述。&lt;/p&gt;
&lt;p&gt;老师竟然说 JSP 没什么好用的编辑器只能在 Eclipse 中写（黑人问号&lt;/p&gt;
&lt;p&gt;明明 IDEA 就很好&amp;hellip;.&lt;/p&gt;
&lt;p&gt;这里记录一下 IDEA 如何配置 JSP 的开发环境&lt;/p&gt;
&lt;h1 id=&#34;intellij-idea-configuration&#34;&gt;IntelliJ IDEA Configuration
&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;新建一个 Java Enterprise 项目，下面 Application Server 选择新建，&lt;/p&gt;
&lt;p&gt;选择 Tomcat Server，设置 Tomcat Home (安装目录)&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;这里需要注意 IDEA 可能会没有权限访问 Tomcat 的目录，导致无法读取 Tomcat，需要手动访问一次该目录提权：
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;* Windows：资源管理器直接访问，会提示需要管理员权限，点继续就 OK 了
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;* Linux：chmod 777
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;下面 Additional Libraries and Frameworks 选择 Web Application，&lt;/p&gt;
&lt;p&gt;点 Next，改名创建，得到如下图所示结构的项目&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;打开 index.jsp&lt;/p&gt;
&lt;p&gt;打开右上角 Edit Configuration&lt;/p&gt;
&lt;p&gt;选择 Application server&lt;/p&gt;
&lt;p&gt;URL 一般是：http://localhost:8080/demo_war_exploded/&lt;/p&gt;
&lt;p&gt;其中 demo 为项目名字，_war_exploded 为自动生成的后缀，需要保留&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;打开 Deployment，界面应如下图&lt;/p&gt;
&lt;p&gt;如果这个 war_exploded 没有出现在里面的话点击右边加号自己加进去&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;简单写一下 index.jsp&lt;/p&gt;
&lt;p&gt;比如下面实现了一个简单的 Hello world 的页面&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;html&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &amp;lt;title&amp;gt;Hello world!&amp;lt;/title&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &amp;lt;body&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &amp;lt;%=out.println(&amp;#34;Hello world!&amp;#34;)%&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &amp;lt;/body&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;/html&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;点击右上角 Run，开始运行
&lt;code&gt;update：21.9.22&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;切回至“Server”，在“Open Browser”设置里，&lt;/p&gt;
&lt;p&gt;建议勾选上“After Launch”，意思为当启动TomCat后，自动打开浏览器并运行项目，此时同样可以在别的浏览器手动输入地址进行访问。&lt;/p&gt;
&lt;p&gt;建议将&lt;code&gt;“On &#39;Update&#39; action”&lt;/code&gt;和&lt;code&gt;“On frame deactivation”&lt;/code&gt;设置为&lt;code&gt;“Update classes and resources”&lt;/code&gt;，这样当修改项目内容时会自动更新字节码文件和资源文件，避免反复重启TomCat服务器：&lt;/p&gt;
&lt;h1 id=&#34;question--solution&#34;&gt;Question &amp;amp; Solution
&lt;/h1&gt;&lt;p&gt;运行之后会大概率出现以下问题，不要问我怎么知道的…&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;端口超界，不能为 - 1&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;原因：Tomcat 安装的默认 Shutdown 端口为 - 1，需要修改一下&lt;/p&gt;
&lt;p&gt;解决：打开 Tomcat 安装目录下的 server.xml，类似如下路径&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;C:\Program Files\apache-tomcat-8.5.71-windows-x64\apache-tomcat-8.5.71\conf\server.xml
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;修改&lt;code&gt;shutdown port&lt;/code&gt;为任一未被占用的端口 (1024 - 65535)，如&lt;code&gt;8005&lt;/code&gt;位置&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;端口 8080 已被占用&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;原因：Tomcat 运行中并占用了 8080 端口&lt;/p&gt;
&lt;p&gt;解决：打开刚才的 Edit Configuration，修改 Tomcat Server Settings 中的 HTTP port 为任一未被占用的端口 (1024 - 65535)，如”8088”，同时别忘修改上面的 URL 的端口&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;output 输出乱码&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;原因：Tomcat 根据你的操作系统默认语言使用了 GBK 编码&lt;/p&gt;
&lt;p&gt;解决：打开 Tomcat 安装目录下的 &lt;code&gt;logging.properties&lt;/code&gt;，类似如下路径&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;C:\Program Files\apache-tomcat-8.5.71-windows-x64\apache-tomcat-8.5.71\conf\logging.properties
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;修改大约第 47 行的&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;java.util.logging.ConsoleHandler.encoding = UTF-8
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;为&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;java.util.logging.ConsoleHandler.encoding = GBK
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;打开网页 404&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;原因：URL 写错了，定位不到文件&lt;/p&gt;
&lt;p&gt;解决：Edit Configuration 中检查一下 URL 是否与端口设置一致，是否正确定位了文件路径&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;输出一堆红色字&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;正常现象，开发者选色鬼才&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;网页调试的方法&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;运行之后修改了代码，怎么才能重新看到修改后的网页呢？&lt;/p&gt;
&lt;p&gt;无需终止 Tomcat 重新运行，只需在左下这个位置点击 Deploy，然后刷新网页就可以啦&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://yaoxiaoxie.github.io/JSP1.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;20210917213934&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;如果没有问题此时应该可以正确运行啦，开始在 IDE 中愉快的写 JSP 吧（雾&lt;/p&gt;
&lt;p&gt;基本语法
因为了解不深，详细的就不多说了。&lt;/p&gt;
&lt;p&gt;除了特别的这几个，其他的都和 HTML 与 Java 语法规则差不多。&lt;/p&gt;
&lt;p&gt;脚本
&amp;lt;%
//在这里编写你的Java代码
%&amp;gt;
任何文本、HTML 标签、JSP 元素必须写在脚本程序的外面&lt;/p&gt;
&lt;p&gt;声明
&amp;lt;%!
//Java
%&amp;gt;
用于声明变量、方法，要写函数只能在这里面&lt;/p&gt;
&lt;p&gt;必须先声明才可以使用&lt;/p&gt;
&lt;p&gt;表达式
&amp;lt;%= //Java %&amp;gt;
表达式里面的代码可以不写分号&lt;/p&gt;
&lt;p&gt;注释
&amp;lt;%&amp;ndash; 该部分注释在网页中不会被显示 &amp;ndash;%&amp;gt;&lt;/p&gt;
&lt;!-- 该部分注释在网页源代码中会被显示 --&gt; 
&lt;p&gt;指令
&amp;lt;%@ page 页面属性 %&amp;gt;
&amp;lt;%@ include 包含文件 %&amp;gt;
&amp;lt;%@ taglib 标签 %&amp;gt;
模板
&amp;lt;%@ page language=&amp;ldquo;java&amp;rdquo; contentType=&amp;ldquo;text/html; charset=UTF-8&amp;rdquo; pageEncoding=&amp;ldquo;UTF-8&amp;rdquo; %&amp;gt;&lt;/p&gt;
&lt;!--导入的Java包--&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;网页标题&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;p&gt;&amp;lt;%!
//定义变量
%&amp;gt;&lt;/p&gt;
&lt;p&gt;&amp;lt;%!
//定义函数
%&amp;gt;&lt;/p&gt;
&lt;p&gt;&amp;lt;%
//脚本
%&amp;gt;&lt;/p&gt;
&lt;!-- 在这里定义其他网页上展示的组件 --&gt;
&lt;/body&gt;
&lt;/html&gt;
示例：计算 N 的阶乘
&lt;%@ page contentType=&#34;text/html;charset=UTF-8&#34; language=&#34;java&#34; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Calc&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div style=&#34;text-align: center;&#34;/&gt;
&lt;h1&gt;
  Calculate N!
&lt;/h1&gt;
&lt;!--*.jsp--&gt;
&lt;form action=&#34;index.jsp&#34;/&gt;
&lt;input type=&#34;number&#34; name=&#34;num&#34;/&gt;&lt;br/&gt;&lt;br/&gt;
&lt;input type=&#34;submit&#34;/&gt;&lt;br/&gt;&lt;br/&gt;
&lt;form/&gt;
&lt;p&gt;&amp;lt;%!
private int n = -1;
%&amp;gt;
&amp;lt;%!
public int fac(int n) {
if (n &amp;lt; 0) {
return n;
} else if (n == 0) {
return 1;
} else {
int product = 1;
for (int i = 1; i &amp;lt;= n; i++) {
product *= i;
if (product &amp;lt; 0) {
break;
}
}
return product;
}
}
%&amp;gt;
&amp;lt;%
try {
int n = fac(Integer.parseInt(request.getParameter(&amp;ldquo;num&amp;rdquo;)));
if (n &amp;lt; 0) {
out.print(&amp;quot;&lt;h2&gt;invalid&lt;/h2&gt;&amp;quot;);
} else {
out.print(&amp;quot;&lt;h2&gt;&amp;quot;+n+&amp;quot;&lt;/h2&gt;&amp;quot;);
}
} catch (Exception e) {
//ignore java.lang.NumberFormatException: null
}
%&amp;gt;&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
示例：数据库查询系统
依赖包：mysql-connector-java-5.1.*.jar
可能需要将 jar 包拷贝到项目路径下的 WEB-INF/lib 中（不存在就新建）
&lt;%@ page contentType=&#34;text/html;charset=UTF-8&#34; language=&#34;java&#34; %&gt;
&lt;%@ page import=&#34;java.sql.*&#34; %&gt;
&lt;%@ page import=&#34;java.io.*&#34; %&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Database Query System&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div style=&#34;text-align: center;&#34;&gt;
    &lt;h1&gt;Database Query System&lt;/h1&gt;
    &lt;h2&gt;powered by bipy&lt;/h2&gt;&lt;br/&gt;
    &lt;form method=&#34;post&#34;&gt;
        &lt;textarea name=&#34;SQL_statement&#34; rows=10 cols=100&gt;&lt;/textarea&gt;&lt;br/&gt;
        &lt;input type=&#34;submit&#34; name=&#34;Submit&#34;/&gt;
        &lt;input type=&#34;reset&#34; name=&#34;Clear&#34;/&gt;
    &lt;/form&gt;
&lt;/div&gt;
&lt;br/&gt;
&lt;/body&gt;
&lt;%!
    private Statement statement;
    private String sql_input;
    private Connection connection;
    private boolean status = false;
%&gt;
&lt;%!
    //判断SQL语句类型，并返回结果（影响个数/报错/结果集）
    public Object process(String sql) {
        try {
            if (sql.toLowerCase().matches(&#34;^(update|create|use|drop|delete|insert).*$&#34;)) {
                return statement.executeUpdate(sql);
            } else if (sql.toLowerCase().matches(&#34;^(show|select).*$&#34;)) {
                return statement.executeQuery(sql);
            } else {
                return &#34;Not Supported&#34;;
            }
        } catch (SQLException e) {
            e.printStackTrace();
            return &#34;SQL syntax error&#34;;
        }
    }
%&gt;
&lt;%
    try {
        //避免重新建立连接而丢弃前面步骤
        if (!status) {
            Class.forName(&#34;com.mysql.jdbc.Driver&#34;);
            connection = DriverManager.getConnection(&#34;jdbc:mysql://localhost&#34;, &#34;root&#34;, &#34;123&#34;);
            statement = connection.createStatement();
            status = true;
        }
    } catch (Exception e) {
        e.printStackTrace();
    }
%&gt;
&lt;div style=&#34;text-align: center&#34;&gt;
    &lt;%
    	//结果输出
        sql_input = request.getParameter(&#34;SQL_statement&#34;);
        if (sql_input != null) {
            Object rt = process(sql_input);
            if (rt instanceof String) {
                out.print(&#34;&lt;h2&gt;&#34; + rt.toString() + &#34;&lt;/h2&gt;&#34;);
            } else if (rt instanceof Integer) {
                out.print(&#34;&lt;h2&gt;&#34; + &#34;Query OK. &#34; + rt + &#34; effected.&#34; + &#34;&lt;/h2&gt;&#34;);
            } else {
                ResultSet rs = (ResultSet) rt;
                ResultSetMetaData rsmd = rs.getMetaData();
                out.println(&#34;&lt;table align=\&#34;center\&#34; border=\&#34;1\&#34;&gt;&#34;);
                out.println(&#34;&lt;tr&gt;&#34;);
                for (int i = 1; i &lt;= rsmd.getColumnCount(); ++i)
                    out.println(&#34;&lt;th&gt;&#34; + rsmd.getColumnName(i) + &#34;&lt;/th&gt;&#34;);
                out.println(&#34;&lt;tr&gt;&#34;);
                while (rs.next()) {
                    out.println(&#34;&lt;tr&gt;&#34;);
                    for (int i = 1; i &lt;= rsmd.getColumnCount(); ++i)
                        out.println(&#34;&lt;td&gt;&#34; + rs.getString(i) + &#34;&lt;/td&gt;&#34;);
                    out.println(&#34;&lt;/tr&gt;&#34;);
                }
                out.println(&#34;&lt;/table&gt;&#34;);
            }
        }
    %&gt;
&lt;/div&gt;
&lt;/html&gt;
posted @ 2021-09-17 21:41  RioTian  阅读(2184)  评论(0)  编辑  收藏  举报
</description>
        </item>
        
    </channel>
</rss>
